#!/usr/bin/env sh

echo -n "Checking dependencies..."
command -v git   >/dev/null 2>&1 || { echo >&2 "git is not installed. Aborting.";   exit 1; }
command -v zsh   >/dev/null 2>&1 || { echo >&2 "zsh is not installed. Aborting.";   exit 1; }
command -v tmux  >/dev/null 2>&1 || { echo >&2 "tmux is not installed. Aborting.";  exit 1; }
command -v vim   >/dev/null 2>&1 || { echo >&2 "vim is not installed. Aborting.";   exit 1; }
command -v ctags >/dev/null 2>&1 || { echo >&2 "ctags is not installed. Aborting."; exit 1; }
echo "passed.\n"

echo -n "Backing up previous configuration files..."
[ -h ~/.bashrc ]        && mv ~/.bashrc ~/.bashrc-bkp
[ -h ~/.bash_aliases ]  && mv ~/.bash_aliases ~/.bash_aliases-bkp
[ -h ~/.zshrc ]         && mv ~/.zshrc ~/.zshrc-bkp
[ -h ~/.vim ]           && mv ~/.vim ~/.vim-bkp
[ -h ~/.vimrc ]         && mv ~/.vimrc ~/.vimrc-bkp
[ -h ~/.tmux.conf ]     && mv ~/.tmux.conf ~/.tmux.conf-bkp
[ -h ~/.gitconfig ]     && mv ~/.gitconfig ~/.gitconfig-bkp
echo "done.\n"

echo -n "Creating the symlinks..."
ln -s ~/.myutilitybelt/bash/bashrc ~/.bashrc
ln -s ~/.myutilitybelt/bash/bash_aliases ~/.bash_aliases
ln -s ~/.myutilitybelt/zsh/zshrc ~/.zshrc
ln -s ~/.myutilitybelt/vim ~/.vim
ln -s ~/.myutilitybelt/vim/vimrc ~/.vimrc
ln -s ~/.myutilitybelt/tmux/tmux.conf ~/.tmux.conf
ln -s ~/.myutilitybelt/git/gitconfig ~/.gitconfig
echo "done.\n"

echo -n "Installing Vim plugins..."
vim -N -u ~/.myutilitybelt/vim/vundle.vim -c ':BundleCleanInstallQuit'
echo "done.\n"

echo "--- Installation of myutilitybelt complete ---"
exit 0
